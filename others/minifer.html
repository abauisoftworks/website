<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Abaui - Script Minifier</title>
    <meta property="og:title" content="Abaui - Minifier">
    <meta property="og:description" content="Professional Roblox Luau Minifier with premium Abaui design.">
    <meta property="og:image" content="https://abaui.vercel.app/icons/abaui.png">
    <link rel="icon" href="icons/abaui.png" type="image/png">
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@900,700,500,400&f[]=general-sans@500,600,700&f[]=clash-display@600,500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ffffff; --secondary: #f8fafc; --accent: #0ea5e9; --text: #0f172a;
            --surface: rgba(255, 255, 255, 0.7); --gradient: linear-gradient(135deg, #0ea5e9, #6366f1);
            --bg-gradient: linear-gradient(135deg, #f8fafc, #ffffff); --text-shadow: 0 0 20px rgba(14, 165, 233, 0.2);
            --hover-gradient: linear-gradient(135deg, #6366f1, #0ea5e9); --nav-bg: rgba(255, 255, 255, 0.7);
            --border-color: rgba(15, 23, 42, 0.05); --hover-bg: rgba(14, 165, 233, 0.1);
            --glow: 0 0 30px rgba(14, 165, 233, 0.15); --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.05);
            --transition: cubic-bezier(0.16, 1, 0.3, 1);
        }
        [data-theme="dark"] {
            --primary: #0f172a; --secondary: #1e293b; --accent: #38bdf8; --text: #f8fafc;
            --surface: rgba(15, 23, 42, 0.7); --gradient: linear-gradient(135deg, #38bdf8, #6366f1);
            --bg-gradient: linear-gradient(135deg, #0f172a, #1e293b); --text-shadow: 0 0 20px rgba(56, 189, 248, 0.2);
            --hover-gradient: linear-gradient(135deg, #6366f1, #38bdf8); --nav-bg: rgba(15, 23, 42, 0.7);
            --border-color: rgba(255, 255, 255, 0.05); --glow: 0 0 30px rgba(56, 189, 248, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'General Sans', sans-serif; background: var(--bg-gradient); color: var(--text);
            min-height: 100dvh; overflow: hidden; display: flex; flex-direction: column;
        }

        .nav {
            padding: 1.25rem 7%; display: flex; justify-content: space-between; align-items: center;
            background: var(--nav-bg); backdrop-filter: blur(10px) saturate(180%);
            border-bottom: 1px solid var(--border-color); z-index: 1000;
        }
        .logo {
            font-family: 'Clash Display', sans-serif; font-size: 1.5rem; font-weight: 600;
            background: var(--gradient); -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent; letter-spacing: -0.02em; transition: all 1s ease;
        }

        .main-container { flex: 1; padding: 2rem 7%; display: flex; flex-direction: column; gap: 1.5rem; min-height: 0; }
        
        .mode-selector { display: flex; gap: 0.5rem; }
        .pill-btn {
            background: var(--surface); border: 1px solid var(--border-color); color: var(--text);
            padding: 0.6rem 1.2rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;
            cursor: pointer; transition: all 0.5s var(--transition); text-transform: uppercase;
        }
        .pill-btn.active { background: var(--gradient); color: white; border-color: transparent; box-shadow: var(--glow); }

        .editor-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; flex: 1; min-height: 0; }
        @media (max-width: 768px) { .editor-grid { grid-template-columns: 1fr; } }

        .editor-card {
            background: var(--surface); backdrop-filter: blur(20px); border-radius: 24px;
            border: 1px solid var(--border-color); display: flex; flex-direction: column;
            overflow: hidden; transition: all 0.5s var(--transition);
        }
        .editor-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg), var(--glow); border-color: var(--accent); }
        
        .card-header { 
            padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
        }
        .card-title { font-family: 'Clash Display'; font-size: 0.9rem; font-weight: 600; opacity: 0.6; }

        .action-btn {
            padding: 0.6rem 1.2rem; background: var(--gradient); color: white; border: none;
            border-radius: 10px; font-weight: 600; font-size: 0.75rem; cursor: pointer;
            transition: all 0.4s var(--transition);
        }
        .action-btn:hover { background: var(--hover-gradient); transform: translateY(-2px); box-shadow: var(--glow); }

        .text-area-wrapper { display: flex; flex: 1; min-height: 0; }
        .gutter { 
            width: 3.5rem; padding: 1.5rem 0; text-align: right; opacity: 0.2; 
            border-right: 1px solid var(--border-color); font-family: monospace; font-size: 13px;
        }
        textarea {
            flex: 1; background: transparent; border: none; outline: none; padding: 1.5rem;
            color: var(--text); font-family: monospace; resize: none; font-size: 14px;
            line-height: 1.6;
        }

        .footer { padding: 1.5rem 7%; display: flex; justify-content: space-between; align-items: center; }
        .footer-text { font-size: 0.75rem; opacity: 0.4; font-weight: 500; }

        @keyframes heroFadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-up { animation: heroFadeUp 0.8s var(--transition) forwards; }
    </style>
</head>
<body>

    <nav class="nav">
        <div class="logo">Abaui</div>
        <div class="nav-controls">
            <span class="version-text" style="position:static; margin-right:10px; opacity:0.5; font-size:0.7rem">V1.3.0</span>
            <button onclick="toggletheme()" class="theme-toggle">
                <svg class="sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                <svg class="moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg>
            </button>
        </div>
    </nav>

    <main class="main-container animate-up">
        <div class="mode-selector">
            <button onclick="setmode('weak')" id="m-weak" class="pill-btn">Weak</button>
            <button onclick="setmode('medium')" id="m-medium" class="pill-btn">Medium</button>
            <button onclick="setmode('strong')" id="m-strong" class="pill-btn">Strong</button>
            <button onclick="setmode('very-strong')" id="m-very-strong" class="pill-btn active">Very Strong</button>
        </div>

        <div class="editor-grid">
            <div class="editor-card">
                <div class="card-header">
                    <span class="card-title">RAW LUAU</span>
                    <button onclick="dopaste()" class="action-btn">Paste</button>
                </div>
                <div class="text-area-wrapper">
                    <div id="gutter-in" class="gutter">1</div>
                    <textarea id="input" spellcheck="false" placeholder="-- Paste your script here..."></textarea>
                </div>
            </div>

            <div class="editor-card">
                <div class="card-header">
                    <span class="card-title">MINIFIED</span>
                    <button onclick="docopy()" id="copy-btn" class="action-btn">Copy</button>
                </div>
                <div class="text-area-wrapper">
                    <div id="gutter-out" class="gutter">1</div>
                    <textarea id="output" readonly spellcheck="false"></textarea>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <span class="footer-text">No logs stored locally. Use a VPN for total anonymity.</span>
        <button onclick="dodownload()" class="action-btn">Download .luau</button>
    </footer>

<script>
    let mode = 'very-strong';
    const elin = document.getElementById('input'), elout = document.getElementById('output');

    function toggletheme() { 
        document.documentElement.setAttribute('data-theme', 
            document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'
        );
    }

    function setmode(m) { 
        mode = m; 
        document.querySelectorAll('.pill-btn').forEach(b => b.classList.toggle('active', b.id === 'm-' + m)); 
        process(); 
    }

    function syncgutter(el, gid) {
        const lines = el.value.split('\n').length;
        let h = ''; for (let i = 1; i <= lines; i++) h += i + '\n';
        const g = document.getElementById(gid);
        g.innerText = h; g.scrollTop = el.scrollTop;
    }

    function process() {
        let c = elin.value;
        if (!c) { elout.value = ""; syncgutter(elin, 'gutter-in'); syncgutter(elout, 'gutter-out'); return; }
        
        c = c.replace(/--\[(=*)\[[\s\S]*?\]\1\]/g, '').replace(/\s*--.*$/gm, '').replace(/^\s*[\r\n]/gm, '');
        
        if (['medium', 'strong', 'very-strong'].includes(mode)) {
            c = c.replace(/\s*([=+*/%^#<>~])\s*/g, '$1');
        }
        
        if (['strong', 'very-strong'].includes(mode)) {
            c = c.replace(/\b([a-zA-Z_]\w*)\s*\(\s*(["'])(.*?)\2\s*\)/g, (m, f, q, content) => 
                (!content.includes('\\') && !content.includes('\n')) ? `${f}'${content}'` : m);
            c = c.replace(/\s+/g, ' ').replace(/\s*([=+\-*/%^#<>~;:,{}()\[\]])\s*/g, '$1').trim();
        }

        if (mode === 'very-strong') {
            let cnt = 0, map = {};
            c = c.replace(/\blocal\s+([a-zA-Z_]\w*)/g, (m, n) => {
                if (["_G", "shared", "script", "game", "workspace"].includes(n)) return m;
                if (!map[n]) {
                    const chars = 'abcdefghijklmnopqrstuvwxyz';
                    let r = '', i = cnt++;
                    while (i >= 0) { r = chars[i % 26] + r; i = Math.floor(i / 26) - 1; }
                    map[n] = r;
                }
                return `local ${map[n]}`;
            });
        }
        
        elout.value = c;
        syncgutter(elin, 'gutter-in'); 
        syncgutter(elout, 'gutter-out');
    }

    async function dopaste() { try { elin.value = await navigator.clipboard.readText(); process(); } catch(e) {} }
    
    function docopy() { 
        navigator.clipboard.writeText(elout.value); 
        const b = document.getElementById('copy-btn');
        const old = b.innerText; b.innerText = "Copied!"; 
        setTimeout(() => b.innerText = old, 1000); 
    }

    function dodownload() {
        if(!elout.value) return;
        const blob = new Blob([elout.value], {type: 'text/plain'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "minified_" + Date.now() + ".luau";
        a.click();
    }

    elin.oninput = process;
    elin.onscroll = () => syncgutter(elin, 'gutter-in');
    elout.onscroll = () => syncgutter(elout, 'gutter-out');
</script>
</body>
</html>
